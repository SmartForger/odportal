<div class="widgetModalCovers" [ngClass]="{'widgetModalHidden': isHidden() }" (click)="hide()"></div>
<div class="widgetModal" [ngClass]="{'widgetModalHidden': isHidden() }">
  <button mat-icon-button matTooltip="Close" (click)="hide()" class="float-right mt-n1 mr-n1 opacity-half">
    <mat-icon>clear</mat-icon>
  </button>

  <h2 mat-dialog-title style="margin-top:-5px;">Add Widget</h2>

  <input #widgetSearchBar id='test' type="text" label="Search" placeholder="Filter by Widget Name" (keyup)="cdr.detectChanges()"/>

  <div class="widgetsList" style="max-width:900px;margin-right:-10px;">
    <span *ngFor="let app of apps">
      <span *ngIf="app.widgets">
        <div class="widgetBlock display-inline-block mb-1 mr-1" *ngFor="let widget of app.widgets">
          <div *ngIf="filterWidget(widget.widgetTitle)">
            <button mat-stroked-button color="secondary" class="full-width" [matMenuTriggerFor]="widgetMenu">
              <button mat-mini-fab class="widgetOptions" color="secondary">
                <mat-icon aria-label="Widget Options">more_vert</mat-icon>
              </button>
              <mat-icon *ngIf="app.native" class="md-icon mt-2">widgets</mat-icon>
              <img *ngIf="!app.native" class="mt-2" style="width: 45px; height: 45px;" [src]="getWidgetIcon(widget, app)" title="{{widget.widgetTitle}}" />
              <h3 class="my-1">{{widget.widgetTitle}}</h3>
              <div class="widgetDescription">
                <span *ngIf="widget.descriptionFull">{{widget.descriptionFull}}</span>
                <span *ngIf="!widget.descriptionFull && widget.descriptionShort">{{widget.descriptionFull}}</span>
                <span *ngIf="!widget.descriptionFull && !widget.descriptionShort">No description provided</span>
              </div>
            </button>
            <mat-menu #widgetMenu="matMenu" [overlapTrigger]="true" xPosition="after">
              <button mat-menu-item (click)="popout({app: app, widget: widget})">
                <mat-icon>launch</mat-icon>
                <span>Launch Widget</span>
              </button>
              <button mat-menu-item (click)="this.addWidget({app: app, widget: widget})" *ngIf='onDashboard()'>
                <mat-icon>dashboard</mat-icon>
                <span>Add to Dashboard</span>
              </button>
              <button mat-menu-item (click)="this.viewDetails({app: app, widget: widget})">
                <mat-icon>info</mat-icon>
                <span>View Details</span>
              </button>
              <!-- <button mat-menu-item>
                <mat-icon>offline_bolt</mat-icon>
                <span>Assign to Hotbar</span>
              </button> -->
            </mat-menu>
          </div>
        </div>
      </span>
    </span>
  </div>

  <app-widget-details *ngIf="this.detailAww" class="widgetModal"
    [aww]="this.detailAww"
    (close)="this.detailAww = null"
    (popout)="this.popout($event)"
    (addToDashboard)="this.addWidget($event)"
  ></app-widget-details>
</div>
