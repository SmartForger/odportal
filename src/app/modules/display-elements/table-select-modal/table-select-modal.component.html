<div mat-dialog-title>
  <h4 class="title">{{data.title}}</h4>
  <button mat-icon-button mat-dialog-close class="close-button">
      <mat-icon>close</mat-icon>
  </button>
</div>

<div mat-dialog-content>
  <div class="table-wrapper">
    <app-listview-toolbar
      [createButtonTitle]="'Create user'"
      [disabled]='!allItemsFetched'
      [searchPlaceholder]="data.searchPlaceholder || 'Search'"
      [showCreateButton]="false"
      [showRefreshButton]="false"
      (search)="filter($event)"
    ></app-listview-toolbar>
    <table
      mat-table
      matSort
      matSortDisableClear
      class="table"
      [dataSource]="displayItems"
      [matSortActive]="currentSort.active"
      [matSortDirection]="currentSort.direction"
      (matSortChange)="sortChange($event)"
    >
      <ng-container matColumnDef="username">
        <th mat-header-cell mat-sort-header *matHeaderCellDef>Username</th>
        <td mat-cell *matCellDef="let row">
          <div class="v-center">
            <mat-icon class="avatar" *ngIf="data.columns[0] === 'username' && filteredSelectedData.indexOf(row) < 0">person</mat-icon>
            <div class="avatar mr-1" *ngIf="data.columns[0] === 'username' && filteredSelectedData.indexOf(row) >= 0">
              <mat-checkbox [checked]="true" color="primary"></mat-checkbox>
            </div>
            <span>{{row.username}}</span>
          </div>
        </td>
      </ng-container>
      <ng-container matColumnDef="fullname">
        <th mat-header-cell mat-sort-header *matHeaderCellDef>Full name</th>
        <td mat-cell *matCellDef="let row">{{row.firstName}} {{row.lastName}}</td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="data.columns"></tr>
      <tr
        class="clickable"
        (click)="select(row)"
        mat-row
        *matRowDef="let row; columns: data.columns;"
      ></tr>
    </table>
    <div [ngClass]="{'pagination': true, 'missing-items': !allItemsFetched}">
      <span *ngIf='allItemsFetched'>{{items.length}} Total Members</span>
      <mat-paginator [length]='paginatorLength()' [pageSizeOptions]="[10, 25, 50, 100]"
          [showFirstLastButtons]='allItemsFetched'></mat-paginator>
    </div>
  </div>
</div>

<div mat-dialog-actions>
  <button
      type="submit"
      color="primary"
      class="primary-button"
      mat-raised-button
      (click)="submit()"
  >
    {{ data.buttonLabel }}
  </button>
  <button mat-button mat-dialog-close class="opacity-half">Cancel</button>
</div>