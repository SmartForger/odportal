<div class='dashboard-manager-header'>
    <app-page-title [pageTitle]="'Dashboard Manager'"></app-page-title>
    <h1>Dashboard Manager</h1>
    <button mat-mini-fab color="primary" class="ml-2" (click)="onCreateClick()" matTooltip="Add Vendor">
      <mat-icon>add_user</mat-icon>
    </button>
</div>

<div *ngIf='dashboard' class='dashboard-preview'>
    <div class='dashboard-controls'>
        <h1>{{ dashboard.title }}</h1>
        <button (click)="onSave()">Save</button>
    </div>
    <app-dashboard-preview #gridsterComponent [dashboard]='dashboard'></app-dashboard-preview>
</div>

<div class='dashboard-picker'>
    <mat-tab-group mat-stretch-tabs (selectedTabChange)='onRoleChange($event)'>
        <mat-tab label='Blue Cell'></mat-tab>
        <mat-tab label='Red Cell'></mat-tab>
        <mat-tab label='White Cell'></mat-tab>
    </mat-tab-group>
    <mat-action-list>
        <button *ngFor='let template of templates.get(role)' mat-list-item (click)='onDashboardClick(template)'>{{ template.title }}</button>
        <span *ngIf='!templates.has(role) || templates.get(role).length === 0'>No Templates Found</span>
    </mat-action-list>
</div>

<div class="widgetListContainer">
    <h2 mat-dialog-title style="margin-top: -5px;">Add Widget</h2>
    <input #widgetSearchBar type="text" label="Search" placeholder="Filter by Widget Name" (keyup)="updateFilter()"/>
    <div class="widgetList">
        <ng-container *ngFor="let app of apps">
            <ng-container *ngIf="app.widgets">
                <div class="widgetBlock display-inline-block mb-1 mr-1" *ngFor="let widget of app.widgets">
                    <ng-container *ngIf="filterWidget(widget.widgetTitle)">
                        <button mat-stroked-button color="secondary" class="full-width full-height" (click)='onWidgetClick(app, widget)'>
                            <mat-icon *ngIf="app.native && widget.iconType === 'icon'" class="md-icon mt-2 mb-1 text-center" style="font-size: 60px; width: 100px !important; color: #666;">{{widget.icon}}</mat-icon>
                            <img *ngIf="app.native && widget.iconType === 'image'" class="mt-2" style="max-width: 60px; max-height: 60px;" [src]="'assets/images/' + widget.icon" />
                            <img *ngIf="!app.native" class="mt-2" style="max-width: 60px; max-height: 60px;" [src]="getWidgetIcon(widget, app)" title="{{widget.widgetTitle}}" />
                            <h3 class="mt-0" style="margin-bottom: 5px;">{{widget.widgetTitle}}</h3>
                            <div class="widgetDescription text-center mt-n1 mb-2">
                                <span *ngIf="widget.descriptionFull">{{widget.descriptionFull}}</span>
                                <span *ngIf="!widget.descriptionFull && widget.descriptionShort">{{widget.descriptionShort}}</span>
                                <span *ngIf="!widget.descriptionFull && !widget.descriptionShort">No description was provided for this widget by the vendor.</span>
                            </div>
                        </button>
                    </ng-container>
                </div>
            </ng-container>
        </ng-container>
    </div>
</div>