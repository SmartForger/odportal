<div class="header-new pb-2">
  <h1>Vendor Manager</h1>
</div>

<div class="wrapper">
  <div class="table-container">
    <app-listview-toolbar
      createButtonTitle="Create vendor"
      (create)="showCreateModal()"
      (refresh)="refresh()"
      (search)="filterUsers($event)"
      searchPlaceholder="Search vendors"
    ></app-listview-toolbar>
    
    <table mat-table [dataSource]="displayItems" class="table" matSort matSortActive="name" matSortDisableClear matSortDirection="asc">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Vendor</th>
        <td mat-cell *matCellDef="let vendor">
          <a [routerLink]="['../edit', vendor.docId]" matTooltip="Edit Vendor">
            <div class="logoImage"><img *ngIf="vendor.logoImage" class=" float-left" [src]="fileBasePath + vendor.logoImage" /></div>
            <mat-icon *ngIf="!vendor.logoImage" class="avatar float-left" style="margin: -7px 0 0;">domain</mat-icon>
            <span class="ml-1">{{vendor.name}}</span>
          </a>
        </td>
      </ng-container>

      <ng-container matColumnDef="phone">
        <th mat-header-cell *matHeaderCellDef>Phone</th>
        <td mat-cell *matCellDef="let vendor">
          <span *ngIf="vendor.pocPhone">{{vendor.pocPhone}}</span>
          <span *ngIf="!vendor.pocPhone" class="opacity-half">N/A</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let vendor">
          <span *ngIf="vendor.pocEmail">{{vendor.pocEmail}}</span>
          <span *ngIf="!vendor.pocEmail" class="opacity-half">N/A</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="users">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Users</th>
        <td mat-cell *matCellDef="let vendor">{{vendor.users.length}} <mat-icon class="sm-icon opacity-half">person</mat-icon></td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="text-right">&nbsp;</th>
        <td mat-cell *matCellDef="let vendor" class="text-right">
          <button mat-icon-button [routerLink]="['../edit', vendor.docId]" matTooltip="Edit Vendor">
            <mat-icon>edit</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row: columns: displayedColumns"></tr>

    </table>

    <div [ngClass]="{'pagination': true, 'missing-items': !allItemsFetched}">
      <span *ngIf='allItemsFetched'>{{items.length}} Total Vendors</span>
      <mat-paginator [length]='paginatorLength()' [pageSizeOptions]="[10, 25, 50, 100]"
          [showFirstLastButtons]='allItemsFetched'></mat-paginator>
  </div>
  </div>

</div>