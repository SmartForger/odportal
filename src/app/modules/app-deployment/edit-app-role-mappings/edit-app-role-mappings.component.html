<h2>Role Mappings</h2>
<div class="table-container">
  <app-listview-toolbar
    (refresh)="listRealmRoles()"
    (search)="search($event)"
    searchPlaceholder="Search roles"
    [showCreateButton]="false"
    [menuOptions]="menuOptions"
    [multiSelect]="true"
    (selectionChange)="updateMenuFilter($event)"
  ></app-listview-toolbar>

  <table
    mat-table
    [dataSource]="displayItems"
    class="table"
    matSort
    matSortActive="role"
    matSortDirection="asc"
    matSortDisableClear
  >
    <ng-container matColumnDef="role">
      <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Role</th>
      <td mat-cell *matCellDef="let rwp">
        <div class="title">
          <mat-icon class="avatar">people</mat-icon>
          {{rwp.role.name}}
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="client">
      <th mat-header-cell *matHeaderCellDef disableClear>Client</th>
      <td mat-cell *matCellDef="let rwp">
        <div class="faux-chip monospace opacity-twothird mx-0 size-12">{{app.clientName}}</div>
      </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Status</th>
      <td mat-cell *matCellDef="let rwp">
        <div class="faux-chip monospace opacity-twothird mx-0 size-12 status-green" *ngIf="rwp.role.active">Assigned</div>
        <div class="faux-chip monospace opacity-twothird mx-0 size-12 status-grey" *ngIf="!rwp.role.active">Unassigned</div>
      </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef class="text-right">&nbsp;</th>
      <td mat-cell *matCellDef="let rwp" class="text-right">
        <button
          mat-icon-button
          (click)="showPermissionEditor(rwp, $event)"
          matTooltip="View Permissions"
        >
          <mat-icon>lock</mat-icon>
        </button>
      </td>
    </ng-container>

    <ng-container matColumnDef="nodata">
      <td mat-footer-row *matFooterCellDef [colSpan]="displayedColumns.length"  style="text-align: center;">
        <img class='no-roles' src="assets/images/no-roles-mapped.png">
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row: columns: displayedColumns"></tr>
    <tr mat-footer-row [hidden]="displayItems.length > 0" *matFooterRowDef="['nodata']"></tr>
  </table>

  <div class="pagination">
    <span>{{ totalRoles }}</span>
    <mat-paginator
      [pageSizeOptions]="[10, 25, 50, 100]"
      [pageSize]="10"
      showFirstLastButtons
    ></mat-paginator>
  </div>
</div>
<!-- <table class="table">
  <thead>
    <tr>
      <th class="text-center" width="25">Status</th>
      <th>Role</th>
      <th>Client</th>
    </tr>
  </thead>
  <tbody>
    <ng-container *ngFor="let rwp of rwps">
      <tr [class.no-border]="rwp.expanded" (click)="toggleRowOpen(rwp)">
        <td width="50">
          <mat-icon class="avatar">people</mat-icon>
          <div class="position-relative">
            <div class="position-absolute" style="bottom: -7px; left: 27px;">
              <span *ngIf="rwp.role.active" matTooltip="Role Enabled">
                <mat-icon class="color-green">brightness_1</mat-icon>
              </span>
              <span *ngIf="!rwp.role.active" matTooltip="Role Disabled">
                <mat-icon class="color-red">brightness_1</mat-icon>
              </span>
            </div>
          </div>
        </td>
        <td>
          <div class="title">
            {{rwp.role.name}}
            <button mat-icon-button *ngIf="!rwp.expanded" matTooltip="Expand Roles Mapped">
              <mat-icon>keyboard_arrow_down</mat-icon>
            </button>
            <button mat-icon-button *ngIf="rwp.expanded" matTooltip="Collapse Roles Mapped">
              <mat-icon>keyboard_arrow_up</mat-icon>
            </button>
          </div>
        </td>
        <td>
          {{clientName}}
        </td>
      </tr>
      <tr *ngIf="rwp.expanded" class="rolesRow">
        <td colspan="4">
          <mat-chip-list *ngIf="!rwp.loading && rwp.permissions && rwp.permissions.length > 0">
            <mat-chip
              *ngFor="let p of rwp.permissions"
              class="opacity-half color-white"
              [ngClass]="{ 'bg-green': p.active, 'bg-red': !p.active }"
            >
              {{p.name}}
            </mat-chip>
          </mat-chip-list>
          <span class="opacity-half" *ngIf="!rwp.loading && (!rwp.permissions || rwp.permissions.length === 0)">
            No permissions
          </span>
          <span *ngIf="rwp.loading">Loading ...</span>
        </td>
      </tr>
    </ng-container>
  </tbody>
</table> -->
