<div class="header-new">
  <h1 class="display-inline-block">
    Edit {{app?.appTitle}}
  </h1>

  <span *ngIf="app && (canUpdate || canDelete)">
    <button mat-mini-fab color="secondary" [matMenuTriggerFor]="menu2" class="ml-2 z-1">
      <mat-icon>more_vert</mat-icon>
    </button>
  </span>

  <mat-menu #menu2="matMenu">
    <button class="test-approve-btn" mat-menu-item *ngIf="!app?.approved && !app?.native && canUpdate" (click)="approveApp()">
      <mat-icon class="color-green">done_outline</mat-icon>
      <span>Approve Microapp</span>
    </button>

    <button class="test-test-btn" mat-menu-item [routerLink]="['../../test', app?.docId]" *ngIf="!app?.native">
      <mat-icon>build</mat-icon>
      <span>Test Microapp</span>
    </button>

    <span *ngIf="(app?.approved || app?.native) && canUpdate">
      <button class="test-enable-btn" mat-menu-item *ngIf="!app?.enabled" (click)="enableButtonClicked()">
        <mat-icon>play_arrow</mat-icon>
        <span>Enable Microapp</span>
      </button>

      <button class="test-disable-btn" mat-menu-item *ngIf="app?.enabled" (click)="disableButtonClicked()">
        <mat-icon>pause</mat-icon>
        <span>Disable Microapp</span>
      </button>
    </span>

    <button class="test-delete-btn" mat-menu-item (click)="removeApp()" *ngIf="!app?.native && canDelete">
      <mat-icon>delete</mat-icon>
      <span>Delete Microapp</span>
    </button>
  </mat-menu>

  <mat-select
    class="app-status ml-1"
    [(ngModel)]="appStatus"
    (ngModelChange)="changeAppStatus($event)"
    [disabled]="!canUpdate"
    *ngIf="app && app.approved && !app.native"
  >
    <mat-option value="enabled">Enabled</mat-option>
    <mat-option value="disabled">Disabled</mat-option>
  </mat-select>
  <mat-select
    class="app-status ml-1"
    value="pending"
    disabled
    *ngIf="app && !app.approved && !app.native"
  >
    <mat-option value="pending">Pending</mat-option>
  </mat-select>
</div>

<mat-tab-group [(selectedIndex)]="selectedTab" class="content-body" *ngIf="app">
  <mat-tab label="Overview">
    <div class="wrapper">
      <app-descriptor [app]="app"></app-descriptor>
    </div>
  </mat-tab>
  <mat-tab label="Widgets" *ngIf="app.widgets.length > 0">
    <div class="wrapper">
      <app-widgets [app]="app"></app-widgets>
    </div>
  </mat-tab>
  <mat-tab label="Shared Requests">
    <div class="wrapper">
      <app-shared-requests-tab></app-shared-requests-tab>
    </div>
  </mat-tab>
  <mat-tab label="Role Mappings">
    <div class="wrapper">
      <app-role-mapper [app]="app" [canUpdate]="canUpdate"></app-role-mapper>
    </div>
  </mat-tab>
  <mat-tab label="Discussion" *ngIf="app && !app.native">
    <div class="wrapper">
      <app-comments [vendorId]="app.vendorId" [appId]="app.docId" [isVendor]="false"></app-comments>
    </div>
  </mat-tab>
</mat-tab-group>