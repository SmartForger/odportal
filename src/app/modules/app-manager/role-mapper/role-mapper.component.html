<h2>Role Mappings</h2>
<table class="table">
  <thead>
    <tr>
      <th class="text-center" width="25">Status</th>
      <th>Role</th>
      <th>Client</th>
      <th *ngIf="canUpdate">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <ng-container *ngFor="let rwp of rwps">
      <tr [class.no-border]="rwp.expanded" (click)="toggleRowOpen(rwp)">
        <td class="text-center" width="25">
          <span *ngIf="rwp.role.active" matTooltip="Role Assigned">
            <mat-icon class="color-green">brightness_1</mat-icon>
          </span>
          <span *ngIf="!rwp.role.active" matTooltip="Role Unassigned">
            <mat-icon class="color-red">brightness_1</mat-icon>
          </span>
        </td>
        <td>
          <div class="title">
            {{ rwp.role.name }}
            <mat-icon *ngIf="!rwp.expanded">keyboard_arrow_down</mat-icon>
            <mat-icon *ngIf="rwp.expanded">keyboard_arrow_up</mat-icon>
          </div>
        </td>
        <td>
          {{ app.clientName }}
        </td>
        <td *ngIf="canUpdate" class="text-right">
          <button
            mat-icon-button
            (click)="showPermissionEditor(rwp, $event)"
            matTooltip="View Permissions"
          >
            <mat-icon>lock</mat-icon>
          </button>
          <button
            mat-icon-button
            (click)="toggleRole(rwp, $event)"
            matTooltip="Add Role to App"
            *ngIf="!rwp.role.active"
            class="color-green"
          >
            <mat-icon>add_circle</mat-icon>
          </button>
          <button
            mat-icon-button
            (click)="toggleRole(rwp, $event)"
            matTooltip="Remove Role from App"
            *ngIf="rwp.role.active"
            class="color-red"
          >
            <mat-icon>remove_circle</mat-icon>
          </button>
        </td>
      </tr>
      <tr *ngIf="rwp.expanded">
        <td class="p-80" colspan="4">
          <mat-chip-list *ngIf="!rwp.loading && rwp.permissions && rwp.permissions.length > 0">
            <mat-chip
              *ngFor="let p of rwp.permissions"
              class="opacity-half color-white"
              [ngClass]="{ 'bg-green': p.active, 'bg-red': !p.active }"
            >
              {{ p.name }}
            </mat-chip>
          </mat-chip-list>
          <span *ngIf="!rwp.loading && (!rwp.permissions || rwp.permissions.length === 0)">
            No permissions
          </span>
          <span *ngIf="rwp.loading">Loading ...</span>
        </td>
      </tr>
    </ng-container>
  </tbody>
</table>
